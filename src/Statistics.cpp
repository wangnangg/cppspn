//
// Created by wangnan on 16-1-28.
//

#include "Statistics.h"


double Statistics::Ztable(double prob)
{
    static const double ztable[101] = {-std::numeric_limits<double>::infinity(), -2.32634787404, -2.05374891063,
                                       -1.88079360815, -1.75068607125, -1.64485362695,
                                       -1.5547735946, -1.47579102818, -1.40507156031, -1.34075503369, -1.28155156554,
                                       -1.22652812004, -1.17498679207, -1.12639112904, -1.08031934081, -1.03643338949,
                                       -0.99445788321, -0.954165253146, -0.915365087843, -0.877896295051,
                                       -0.841621233573,
                                       -0.806421247018, -0.772193214189, -0.738846849185, -0.70630256284,
                                       -0.674489750196,
                                       -0.643345405393, -0.612812991017, -0.582841507271, -0.553384719556,
                                       -0.524400512708,
                                       -0.495850347347, -0.467698799115, -0.439913165673, -0.412463129441,
                                       -0.385320466408,
                                       -0.358458793251, -0.331853346437, -0.305480788099, -0.279319034447,
                                       -0.253347103136,
                                       -0.227544976641, -0.201893479142, -0.176374164781, -0.150969215497,
                                       -0.125661346855,
                                       -0.100433720511, -0.0752698620998, -0.0501535834647, -0.0250689082587, 0.0,
                                       0.0250689082587, 0.0501535834647, 0.0752698620998, 0.100433720511,
                                       0.125661346855,
                                       0.150969215497, 0.176374164781, 0.201893479142, 0.227544976641, 0.253347103136,
                                       0.279319034447, 0.305480788099, 0.331853346437, 0.358458793251, 0.385320466408,
                                       0.412463129441, 0.439913165673, 0.467698799115, 0.495850347347, 0.524400512708,
                                       0.553384719556, 0.582841507271, 0.612812991017, 0.643345405393, 0.674489750196,
                                       0.70630256284, 0.738846849185, 0.772193214189, 0.806421247018, 0.841621233573,
                                       0.877896295051, 0.915365087843, 0.954165253146, 0.99445788321, 1.03643338949,
                                       1.08031934081, 1.12639112904, 1.17498679207, 1.22652812004, 1.28155156554,
                                       1.34075503369, 1.40507156031, 1.47579102818, 1.5547735946, 1.64485362695,
                                       1.75068607125, 1.88079360815, 2.05374891063, 2.32634787404,
                                       std::numeric_limits<double>::infinity()};
    int percentile = std::lround(prob * 100);
    if (percentile >= 100)
    {
        percentile = 99;
    } else if (percentile <= 0)
    {
        percentile = 1;
    }
    return ztable[percentile];
}

std::default_random_engine Statistics::generator;

std::function<double()> Statistics::Exp(double lambda)
{
    std::exponential_distribution<double> distribution(lambda);
    return [distribution]() mutable
    {
        return distribution(generator);
    };
}
